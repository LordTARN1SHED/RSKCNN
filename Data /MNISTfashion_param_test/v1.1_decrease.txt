Epoch 1/40
469/469 [==============================] - 4s 2ms/step - loss: 0.4845 - accuracy: 0.8217 - val_loss: 0.3448 - val_accuracy: 0.8776
Epoch 2/40
469/469 [==============================] - 1s 3ms/step - loss: 0.2989 - accuracy: 0.8912 - val_loss: 0.2892 - val_accuracy: 0.8943
Epoch 3/40
469/469 [==============================] - 2s 4ms/step - loss: 0.2582 - accuracy: 0.9043 - val_loss: 0.2739 - val_accuracy: 0.8987
WARNING:tensorflow:5 out of the last 9 calls to <function SparseConv2D.update_p at 0x0000017B5534E1F8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
Epoch 4/40
469/469 [==============================] - 2s 4ms/step - loss: 0.2368 - accuracy: 0.9129 - val_loss: 0.2820 - val_accuracy: 0.8961
WARNING:tensorflow:5 out of the last 11 calls to <function SparseConv2D.update_p at 0x0000017B5534E1F8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
Epoch 5/40
469/469 [==============================] - 2s 4ms/step - loss: 0.2253 - accuracy: 0.9165 - val_loss: 0.2440 - val_accuracy: 0.9102
Epoch 6/40
469/469 [==============================] - 2s 4ms/step - loss: 0.2134 - accuracy: 0.9211 - val_loss: 0.2366 - val_accuracy: 0.9136
Epoch 7/40
469/469 [==============================] - 2s 3ms/step - loss: 0.2128 - accuracy: 0.9207 - val_loss: 0.2245 - val_accuracy: 0.9190
Epoch 8/40
469/469 [==============================] - 2s 4ms/step - loss: 0.2200 - accuracy: 0.9182 - val_loss: 0.2237 - val_accuracy: 0.9191
Epoch 9/40
469/469 [==============================] - 2s 4ms/step - loss: 0.2084 - accuracy: 0.9228 - val_loss: 0.2293 - val_accuracy: 0.9164
Epoch 10/40
469/469 [==============================] - 2s 4ms/step - loss: 0.1967 - accuracy: 0.9269 - val_loss: 0.2165 - val_accuracy: 0.9229
Epoch 11/40
469/469 [==============================] - 2s 3ms/step - loss: 0.1885 - accuracy: 0.9299 - val_loss: 0.2153 - val_accuracy: 0.9218
Epoch 12/40
469/469 [==============================] - 2s 4ms/step - loss: 0.1805 - accuracy: 0.9332 - val_loss: 0.2085 - val_accuracy: 0.9239
Epoch 13/40
469/469 [==============================] - 2s 4ms/step - loss: 0.1732 - accuracy: 0.9360 - val_loss: 0.2163 - val_accuracy: 0.9226
Epoch 14/40
469/469 [==============================] - 2s 4ms/step - loss: 0.1693 - accuracy: 0.9365 - val_loss: 0.2131 - val_accuracy: 0.9248
Epoch 15/40
469/469 [==============================] - 2s 4ms/step - loss: 0.1634 - accuracy: 0.9384 - val_loss: 0.2068 - val_accuracy: 0.9247
Epoch 16/40
469/469 [==============================] - 2s 4ms/step - loss: 0.1565 - accuracy: 0.9419 - val_loss: 0.2030 - val_accuracy: 0.9273
Epoch 17/40
469/469 [==============================] - 2s 4ms/step - loss: 0.1492 - accuracy: 0.9440 - val_loss: 0.2057 - val_accuracy: 0.9230
Epoch 18/40
469/469 [==============================] - 2s 4ms/step - loss: 0.1454 - accuracy: 0.9461 - val_loss: 0.2006 - val_accuracy: 0.9310
Epoch 19/40
469/469 [==============================] - 2s 4ms/step - loss: 0.1425 - accuracy: 0.9470 - val_loss: 0.2069 - val_accuracy: 0.9289
Epoch 20/40
469/469 [==============================] - 2s 4ms/step - loss: 0.1379 - accuracy: 0.9481 - val_loss: 0.2093 - val_accuracy: 0.9293
Epoch 21/40
469/469 [==============================] - 2s 4ms/step - loss: 0.1332 - accuracy: 0.9503 - val_loss: 0.2051 - val_accuracy: 0.9281
Epoch 22/40
469/469 [==============================] - 2s 4ms/step - loss: 0.1286 - accuracy: 0.9519 - val_loss: 0.2116 - val_accuracy: 0.9260
Epoch 23/40
469/469 [==============================] - 2s 4ms/step - loss: 0.1215 - accuracy: 0.9543 - val_loss: 0.2086 - val_accuracy: 0.9264
Epoch 24/40
469/469 [==============================] - 2s 4ms/step - loss: 0.1190 - accuracy: 0.9548 - val_loss: 0.2096 - val_accuracy: 0.9303
Epoch 25/40
469/469 [==============================] - 2s 4ms/step - loss: 0.1213 - accuracy: 0.9544 - val_loss: 0.2186 - val_accuracy: 0.9282
Epoch 26/40
469/469 [==============================] - 2s 4ms/step - loss: 0.1157 - accuracy: 0.9562 - val_loss: 0.2163 - val_accuracy: 0.9303
Epoch 27/40
469/469 [==============================] - 2s 3ms/step - loss: 0.1110 - accuracy: 0.9574 - val_loss: 0.2115 - val_accuracy: 0.9281
Epoch 28/40
469/469 [==============================] - 2s 3ms/step - loss: 0.1073 - accuracy: 0.9587 - val_loss: 0.2112 - val_accuracy: 0.9289
Epoch 29/40
469/469 [==============================] - 2s 3ms/step - loss: 0.1053 - accuracy: 0.9598 - val_loss: 0.2169 - val_accuracy: 0.9287
Epoch 30/40
469/469 [==============================] - 2s 3ms/step - loss: 0.1035 - accuracy: 0.9608 - val_loss: 0.2188 - val_accuracy: 0.9287
Epoch 31/40
469/469 [==============================] - 2s 4ms/step - loss: 0.0975 - accuracy: 0.9634 - val_loss: 0.2089 - val_accuracy: 0.9310
Epoch 32/40
469/469 [==============================] - 2s 4ms/step - loss: 0.0958 - accuracy: 0.9638 - val_loss: 0.2182 - val_accuracy: 0.9298
Epoch 33/40
469/469 [==============================] - 2s 4ms/step - loss: 0.0956 - accuracy: 0.9645 - val_loss: 0.2212 - val_accuracy: 0.9283
Epoch 34/40
469/469 [==============================] - 2s 4ms/step - loss: 0.0929 - accuracy: 0.9647 - val_loss: 0.2120 - val_accuracy: 0.9316
Epoch 35/40
469/469 [==============================] - 2s 4ms/step - loss: 0.0879 - accuracy: 0.9653 - val_loss: 0.2305 - val_accuracy: 0.9317
Epoch 36/40
469/469 [==============================] - 2s 4ms/step - loss: 0.0903 - accuracy: 0.9663 - val_loss: 0.2280 - val_accuracy: 0.9290
Epoch 37/40
469/469 [==============================] - 2s 4ms/step - loss: 0.0847 - accuracy: 0.9680 - val_loss: 0.2191 - val_accuracy: 0.9320
Epoch 38/40
469/469 [==============================] - 2s 4ms/step - loss: 0.0845 - accuracy: 0.9679 - val_loss: 0.2269 - val_accuracy: 0.9335
Epoch 39/40
469/469 [==============================] - 2s 4ms/step - loss: 0.0827 - accuracy: 0.9692 - val_loss: 0.2337 - val_accuracy: 0.9278
Epoch 40/40
469/469 [==============================] - 2s 4ms/step - loss: 0.0823 - accuracy: 0.9690 - val_loss: 0.2247 - val_accuracy: 0.9334
<tensorflow.python.keras.callbacks.History at 0x17783fbcf08>