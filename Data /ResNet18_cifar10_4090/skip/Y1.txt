Epoch 1/100
  5/368 [..............................] - ETA: 10s - loss: 3.8852 - sparse_categorical_accuracy: 0.1516WARNING:tensorflow:Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.0154s vs `on_train_batch_end` time: 0.0211s). Check your callbacks.
368/368 [==============================] - 17s 36ms/step - loss: 1.6275 - sparse_categorical_accuracy: 0.5430 - val_loss: 1.7001 - val_sparse_categorical_accuracy: 0.5118
Epoch 2/100
368/368 [==============================] - 12s 33ms/step - loss: 1.0638 - sparse_categorical_accuracy: 0.7233 - val_loss: 1.1302 - val_sparse_categorical_accuracy: 0.7001
Epoch 3/100
368/368 [==============================] - 13s 34ms/step - loss: 0.8465 - sparse_categorical_accuracy: 0.7927 - val_loss: 1.2875 - val_sparse_categorical_accuracy: 0.6695
Epoch 4/100
368/368 [==============================] - 13s 35ms/step - loss: 0.7212 - sparse_categorical_accuracy: 0.8317 - val_loss: 1.0806 - val_sparse_categorical_accuracy: 0.7177
Epoch 5/100
368/368 [==============================] - 13s 35ms/step - loss: 0.6388 - sparse_categorical_accuracy: 0.8603 - val_loss: 1.2141 - val_sparse_categorical_accuracy: 0.7079
Epoch 6/100
368/368 [==============================] - 13s 35ms/step - loss: 0.5825 - sparse_categorical_accuracy: 0.8846 - val_loss: 1.3701 - val_sparse_categorical_accuracy: 0.6863
Epoch 7/100
368/368 [==============================] - 13s 35ms/step - loss: 0.5468 - sparse_categorical_accuracy: 0.9017 - val_loss: 1.3526 - val_sparse_categorical_accuracy: 0.7046
Epoch 8/100
368/368 [==============================] - 13s 35ms/step - loss: 0.5129 - sparse_categorical_accuracy: 0.9191 - val_loss: 1.0157 - val_sparse_categorical_accuracy: 0.7724
Epoch 9/100
368/368 [==============================] - 13s 34ms/step - loss: 0.4970 - sparse_categorical_accuracy: 0.9285 - val_loss: 1.0849 - val_sparse_categorical_accuracy: 0.7743
Epoch 10/100
368/368 [==============================] - 13s 35ms/step - loss: 0.4712 - sparse_categorical_accuracy: 0.9414 - val_loss: 1.4750 - val_sparse_categorical_accuracy: 0.7238
Epoch 11/100
368/368 [==============================] - 13s 35ms/step - loss: 0.4709 - sparse_categorical_accuracy: 0.9448 - val_loss: 1.0469 - val_sparse_categorical_accuracy: 0.7842
Epoch 12/100
368/368 [==============================] - 13s 35ms/step - loss: 0.4502 - sparse_categorical_accuracy: 0.9544 - val_loss: 1.5894 - val_sparse_categorical_accuracy: 0.6813
Epoch 13/100
368/368 [==============================] - 13s 35ms/step - loss: 0.4421 - sparse_categorical_accuracy: 0.9583 - val_loss: 1.2617 - val_sparse_categorical_accuracy: 0.7590
Epoch 14/100
368/368 [==============================] - 13s 34ms/step - loss: 0.4364 - sparse_categorical_accuracy: 0.9607 - val_loss: 1.2238 - val_sparse_categorical_accuracy: 0.7713
Epoch 15/100
368/368 [==============================] - 13s 35ms/step - loss: 0.4288 - sparse_categorical_accuracy: 0.9645 - val_loss: 1.2475 - val_sparse_categorical_accuracy: 0.7874
Epoch 16/100
367/368 [============================>.] - ETA: 0s - loss: 0.4331 - sparse_categorical_accuracy: 0.9648WARNING:tensorflow:5 out of the last 16 calls to <function SparseConv2D.update_p at 0x00000212DD3EBF70> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
368/368 [==============================] - 13s 35ms/step - loss: 0.4332 - sparse_categorical_accuracy: 0.9647 - val_loss: 1.0607 - val_sparse_categorical_accuracy: 0.7993
Epoch 17/100
368/368 [==============================] - 13s 35ms/step - loss: 0.4264 - sparse_categorical_accuracy: 0.9671 - val_loss: 1.6292 - val_sparse_categorical_accuracy: 0.7099
Epoch 18/100
367/368 [============================>.] - ETA: 0s - loss: 0.4357 - sparse_categorical_accuracy: 0.9644WARNING:tensorflow:6 out of the last 18 calls to <function SparseConv2D.update_p at 0x00000212DD3EBF70> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
368/368 [==============================] - 13s 35ms/step - loss: 0.4357 - sparse_categorical_accuracy: 0.9644 - val_loss: 1.2194 - val_sparse_categorical_accuracy: 0.7904
Epoch 19/100
368/368 [==============================] - 13s 35ms/step - loss: 0.4245 - sparse_categorical_accuracy: 0.9694 - val_loss: 1.5067 - val_sparse_categorical_accuracy: 0.7417
Epoch 20/100
368/368 [==============================] - 13s 35ms/step - loss: 0.4220 - sparse_categorical_accuracy: 0.9697 - val_loss: 1.1829 - val_sparse_categorical_accuracy: 0.8048
Epoch 21/100
368/368 [==============================] - 13s 35ms/step - loss: 0.4074 - sparse_categorical_accuracy: 0.9735 - val_loss: 1.4392 - val_sparse_categorical_accuracy: 0.7522
Epoch 22/100
368/368 [==============================] - 13s 35ms/step - loss: 0.4303 - sparse_categorical_accuracy: 0.9685 - val_loss: 1.3299 - val_sparse_categorical_accuracy: 0.7733
Epoch 23/100
368/368 [==============================] - 13s 35ms/step - loss: 0.4305 - sparse_categorical_accuracy: 0.9687 - val_loss: 1.1545 - val_sparse_categorical_accuracy: 0.8112
Epoch 24/100
368/368 [==============================] - 13s 35ms/step - loss: 0.4143 - sparse_categorical_accuracy: 0.9746 - val_loss: 1.2628 - val_sparse_categorical_accuracy: 0.7783
Epoch 25/100
368/368 [==============================] - 13s 35ms/step - loss: 0.4092 - sparse_categorical_accuracy: 0.9743 - val_loss: 1.6275 - val_sparse_categorical_accuracy: 0.7383
Epoch 26/100
368/368 [==============================] - 13s 35ms/step - loss: 0.4227 - sparse_categorical_accuracy: 0.9716 - val_loss: 1.3838 - val_sparse_categorical_accuracy: 0.7671
Epoch 27/100
368/368 [==============================] - 13s 35ms/step - loss: 0.4055 - sparse_categorical_accuracy: 0.9771 - val_loss: 1.2045 - val_sparse_categorical_accuracy: 0.7868
Epoch 28/100
368/368 [==============================] - 13s 35ms/step - loss: 0.4028 - sparse_categorical_accuracy: 0.9761 - val_loss: 1.5373 - val_sparse_categorical_accuracy: 0.7543
Epoch 29/100
368/368 [==============================] - 13s 35ms/step - loss: 0.4224 - sparse_categorical_accuracy: 0.9722 - val_loss: 1.4572 - val_sparse_categorical_accuracy: 0.7607
Epoch 30/100
368/368 [==============================] - 13s 34ms/step - loss: 0.4015 - sparse_categorical_accuracy: 0.9780 - val_loss: 1.5319 - val_sparse_categorical_accuracy: 0.7402
Epoch 31/100
368/368 [==============================] - 12s 33ms/step - loss: 0.4030 - sparse_categorical_accuracy: 0.9766 - val_loss: 1.2411 - val_sparse_categorical_accuracy: 0.7834
Epoch 32/100
368/368 [==============================] - 12s 33ms/step - loss: 0.3965 - sparse_categorical_accuracy: 0.9783 - val_loss: 1.2892 - val_sparse_categorical_accuracy: 0.7889
Epoch 33/100
368/368 [==============================] - 12s 33ms/step - loss: 0.4003 - sparse_categorical_accuracy: 0.9761 - val_loss: 1.5048 - val_sparse_categorical_accuracy: 0.7513
Epoch 34/100
368/368 [==============================] - 12s 33ms/step - loss: 0.3987 - sparse_categorical_accuracy: 0.9772 - val_loss: 1.3128 - val_sparse_categorical_accuracy: 0.7765
Epoch 35/100
368/368 [==============================] - 12s 33ms/step - loss: 0.4091 - sparse_categorical_accuracy: 0.9758 - val_loss: 1.4795 - val_sparse_categorical_accuracy: 0.7607
Epoch 36/100
368/368 [==============================] - 12s 33ms/step - loss: 0.3943 - sparse_categorical_accuracy: 0.9796 - val_loss: 1.7934 - val_sparse_categorical_accuracy: 0.7072
Epoch 37/100
368/368 [==============================] - 12s 33ms/step - loss: 0.3954 - sparse_categorical_accuracy: 0.9788 - val_loss: 1.2598 - val_sparse_categorical_accuracy: 0.7922
Epoch 38/100
368/368 [==============================] - 13s 35ms/step - loss: 0.4019 - sparse_categorical_accuracy: 0.9771 - val_loss: 1.3757 - val_sparse_categorical_accuracy: 0.7784
Epoch 39/100
368/368 [==============================] - 13s 35ms/step - loss: 0.3719 - sparse_categorical_accuracy: 0.9843 - val_loss: 1.4366 - val_sparse_categorical_accuracy: 0.7606
Epoch 40/100
368/368 [==============================] - 13s 35ms/step - loss: 0.3826 - sparse_categorical_accuracy: 0.9785 - val_loss: 1.7100 - val_sparse_categorical_accuracy: 0.7430
Epoch 41/100
368/368 [==============================] - 13s 35ms/step - loss: 0.3880 - sparse_categorical_accuracy: 0.9784 - val_loss: 1.1937 - val_sparse_categorical_accuracy: 0.7930
Epoch 42/100
368/368 [==============================] - 13s 35ms/step - loss: 0.3790 - sparse_categorical_accuracy: 0.9806 - val_loss: 1.0815 - val_sparse_categorical_accuracy: 0.8204
Epoch 43/100
368/368 [==============================] - 13s 35ms/step - loss: 0.3901 - sparse_categorical_accuracy: 0.9768 - val_loss: 1.1657 - val_sparse_categorical_accuracy: 0.8085
Epoch 44/100
368/368 [==============================] - 13s 34ms/step - loss: 0.3874 - sparse_categorical_accuracy: 0.9792 - val_loss: 1.2639 - val_sparse_categorical_accuracy: 0.7777
Epoch 45/100
368/368 [==============================] - 13s 35ms/step - loss: 0.3567 - sparse_categorical_accuracy: 0.9859 - val_loss: 1.1218 - val_sparse_categorical_accuracy: 0.8013
Epoch 46/100
368/368 [==============================] - 13s 35ms/step - loss: 0.3711 - sparse_categorical_accuracy: 0.9796 - val_loss: 1.6650 - val_sparse_categorical_accuracy: 0.7398
Epoch 47/100
368/368 [==============================] - 13s 35ms/step - loss: 0.3939 - sparse_categorical_accuracy: 0.9755 - val_loss: 1.2580 - val_sparse_categorical_accuracy: 0.7930
Epoch 48/100
368/368 [==============================] - 13s 35ms/step - loss: 0.3650 - sparse_categorical_accuracy: 0.9834 - val_loss: 1.3116 - val_sparse_categorical_accuracy: 0.7988
Epoch 49/100
368/368 [==============================] - 13s 35ms/step - loss: 0.3670 - sparse_categorical_accuracy: 0.9813 - val_loss: 1.2432 - val_sparse_categorical_accuracy: 0.7930
Epoch 50/100
368/368 [==============================] - 13s 35ms/step - loss: 0.3600 - sparse_categorical_accuracy: 0.9829 - val_loss: 1.4931 - val_sparse_categorical_accuracy: 0.7555
Epoch 51/100
368/368 [==============================] - 13s 35ms/step - loss: 0.3717 - sparse_categorical_accuracy: 0.9800 - val_loss: 1.4851 - val_sparse_categorical_accuracy: 0.7738
Epoch 52/100
368/368 [==============================] - 13s 35ms/step - loss: 0.3731 - sparse_categorical_accuracy: 0.9809 - val_loss: 1.1817 - val_sparse_categorical_accuracy: 0.7997
Epoch 53/100
368/368 [==============================] - 13s 35ms/step - loss: 0.3495 - sparse_categorical_accuracy: 0.9854 - val_loss: 1.1197 - val_sparse_categorical_accuracy: 0.8147
Epoch 54/100
368/368 [==============================] - 13s 35ms/step - loss: 0.3649 - sparse_categorical_accuracy: 0.9794 - val_loss: 1.0587 - val_sparse_categorical_accuracy: 0.8173
Epoch 55/100
368/368 [==============================] - 13s 35ms/step - loss: 0.3464 - sparse_categorical_accuracy: 0.9850 - val_loss: 1.2220 - val_sparse_categorical_accuracy: 0.7967
Epoch 56/100
368/368 [==============================] - 13s 35ms/step - loss: 0.3627 - sparse_categorical_accuracy: 0.9807 - val_loss: 1.1071 - val_sparse_categorical_accuracy: 0.8184
Epoch 57/100
368/368 [==============================] - 13s 35ms/step - loss: 0.3450 - sparse_categorical_accuracy: 0.9844 - val_loss: 1.3843 - val_sparse_categorical_accuracy: 0.7815
Epoch 58/100
368/368 [==============================] - 13s 35ms/step - loss: 0.3406 - sparse_categorical_accuracy: 0.9854 - val_loss: 1.2703 - val_sparse_categorical_accuracy: 0.7872
Epoch 59/100
368/368 [==============================] - 13s 35ms/step - loss: 0.3518 - sparse_categorical_accuracy: 0.9808 - val_loss: 1.3309 - val_sparse_categorical_accuracy: 0.7970
Epoch 60/100
368/368 [==============================] - 13s 35ms/step - loss: 0.3475 - sparse_categorical_accuracy: 0.9826 - val_loss: 1.1843 - val_sparse_categorical_accuracy: 0.8124
Epoch 61/100
368/368 [==============================] - 13s 35ms/step - loss: 0.3465 - sparse_categorical_accuracy: 0.9828 - val_loss: 1.2324 - val_sparse_categorical_accuracy: 0.7853
Epoch 62/100
368/368 [==============================] - 13s 35ms/step - loss: 0.3403 - sparse_categorical_accuracy: 0.9836 - val_loss: 1.1307 - val_sparse_categorical_accuracy: 0.8065
Epoch 63/100
368/368 [==============================] - 13s 35ms/step - loss: 0.3353 - sparse_categorical_accuracy: 0.9852 - val_loss: 1.2603 - val_sparse_categorical_accuracy: 0.7948
Epoch 64/100
368/368 [==============================] - 13s 35ms/step - loss: 0.3535 - sparse_categorical_accuracy: 0.9799 - val_loss: 1.0143 - val_sparse_categorical_accuracy: 0.8316
Epoch 65/100
368/368 [==============================] - 13s 35ms/step - loss: 0.3422 - sparse_categorical_accuracy: 0.9828 - val_loss: 1.1295 - val_sparse_categorical_accuracy: 0.8054
Epoch 66/100
368/368 [==============================] - 13s 35ms/step - loss: 0.3266 - sparse_categorical_accuracy: 0.9861 - val_loss: 1.1974 - val_sparse_categorical_accuracy: 0.7958
Epoch 67/100
368/368 [==============================] - 13s 35ms/step - loss: 0.3284 - sparse_categorical_accuracy: 0.9847 - val_loss: 1.0298 - val_sparse_categorical_accuracy: 0.8194
Epoch 68/100
368/368 [==============================] - 13s 35ms/step - loss: 0.3295 - sparse_categorical_accuracy: 0.9836 - val_loss: 1.0725 - val_sparse_categorical_accuracy: 0.8155
Epoch 69/100
368/368 [==============================] - 13s 35ms/step - loss: 0.3235 - sparse_categorical_accuracy: 0.9845 - val_loss: 1.0648 - val_sparse_categorical_accuracy: 0.8234
Epoch 70/100
368/368 [==============================] - 13s 35ms/step - loss: 0.3287 - sparse_categorical_accuracy: 0.9831 - val_loss: 1.2401 - val_sparse_categorical_accuracy: 0.7988
Epoch 71/100
368/368 [==============================] - 13s 35ms/step - loss: 0.3350 - sparse_categorical_accuracy: 0.9823 - val_loss: 1.1026 - val_sparse_categorical_accuracy: 0.8118
Epoch 72/100
368/368 [==============================] - 13s 35ms/step - loss: 0.3386 - sparse_categorical_accuracy: 0.9820 - val_loss: 1.0580 - val_sparse_categorical_accuracy: 0.8213
Epoch 73/100
368/368 [==============================] - 12s 34ms/step - loss: 0.3172 - sparse_categorical_accuracy: 0.9874 - val_loss: 0.9775 - val_sparse_categorical_accuracy: 0.8349
Epoch 74/100
368/368 [==============================] - 12s 33ms/step - loss: 0.3066 - sparse_categorical_accuracy: 0.9876 - val_loss: 1.2414 - val_sparse_categorical_accuracy: 0.7924
Epoch 75/100
368/368 [==============================] - 12s 33ms/step - loss: 0.3318 - sparse_categorical_accuracy: 0.9802 - val_loss: 1.0692 - val_sparse_categorical_accuracy: 0.8246
Epoch 76/100
368/368 [==============================] - 12s 34ms/step - loss: 0.3112 - sparse_categorical_accuracy: 0.9867 - val_loss: 1.0641 - val_sparse_categorical_accuracy: 0.8196
Epoch 77/100
368/368 [==============================] - 13s 35ms/step - loss: 0.3168 - sparse_categorical_accuracy: 0.9840 - val_loss: 1.1796 - val_sparse_categorical_accuracy: 0.8000
Epoch 78/100
368/368 [==============================] - 13s 35ms/step - loss: 0.3262 - sparse_categorical_accuracy: 0.9826 - val_loss: 1.0255 - val_sparse_categorical_accuracy: 0.8232
Epoch 79/100
368/368 [==============================] - 13s 35ms/step - loss: 0.3049 - sparse_categorical_accuracy: 0.9871 - val_loss: 1.0006 - val_sparse_categorical_accuracy: 0.8353
Epoch 80/100
368/368 [==============================] - 13s 35ms/step - loss: 0.3203 - sparse_categorical_accuracy: 0.9830 - val_loss: 1.1594 - val_sparse_categorical_accuracy: 0.8060
Epoch 81/100
368/368 [==============================] - 13s 35ms/step - loss: 0.3052 - sparse_categorical_accuracy: 0.9868 - val_loss: 1.1532 - val_sparse_categorical_accuracy: 0.8116
Epoch 82/100
368/368 [==============================] - 13s 35ms/step - loss: 0.2969 - sparse_categorical_accuracy: 0.9877 - val_loss: 1.0859 - val_sparse_categorical_accuracy: 0.8044
Epoch 83/100
368/368 [==============================] - 13s 35ms/step - loss: 0.3082 - sparse_categorical_accuracy: 0.9842 - val_loss: 1.1247 - val_sparse_categorical_accuracy: 0.8203
Epoch 84/100
368/368 [==============================] - 13s 35ms/step - loss: 0.3031 - sparse_categorical_accuracy: 0.9857 - val_loss: 1.1949 - val_sparse_categorical_accuracy: 0.7968
Epoch 85/100
368/368 [==============================] - 13s 36ms/step - loss: 0.2990 - sparse_categorical_accuracy: 0.9860 - val_loss: 1.2123 - val_sparse_categorical_accuracy: 0.8079
Epoch 86/100
368/368 [==============================] - 13s 35ms/step - loss: 0.3031 - sparse_categorical_accuracy: 0.9849 - val_loss: 1.1132 - val_sparse_categorical_accuracy: 0.8087
Epoch 87/100
368/368 [==============================] - 13s 35ms/step - loss: 0.3067 - sparse_categorical_accuracy: 0.9849 - val_loss: 1.0098 - val_sparse_categorical_accuracy: 0.8314
Epoch 88/100
368/368 [==============================] - 12s 34ms/step - loss: 0.2908 - sparse_categorical_accuracy: 0.9880 - val_loss: 1.1108 - val_sparse_categorical_accuracy: 0.8048
Epoch 89/100
368/368 [==============================] - 13s 34ms/step - loss: 0.2950 - sparse_categorical_accuracy: 0.9861 - val_loss: 1.3739 - val_sparse_categorical_accuracy: 0.7705
Epoch 90/100
368/368 [==============================] - 12s 33ms/step - loss: 0.3031 - sparse_categorical_accuracy: 0.9849 - val_loss: 1.3565 - val_sparse_categorical_accuracy: 0.7820
Epoch 91/100
368/368 [==============================] - 12s 33ms/step - loss: 0.3014 - sparse_categorical_accuracy: 0.9847 - val_loss: 1.0395 - val_sparse_categorical_accuracy: 0.8291
Epoch 92/100
368/368 [==============================] - 12s 34ms/step - loss: 0.2817 - sparse_categorical_accuracy: 0.9899 - val_loss: 1.0882 - val_sparse_categorical_accuracy: 0.8183
Epoch 93/100
368/368 [==============================] - 12s 34ms/step - loss: 0.2991 - sparse_categorical_accuracy: 0.9834 - val_loss: 1.0363 - val_sparse_categorical_accuracy: 0.8155
Epoch 94/100
368/368 [==============================] - 12s 34ms/step - loss: 0.3002 - sparse_categorical_accuracy: 0.9839 - val_loss: 1.0638 - val_sparse_categorical_accuracy: 0.8190
Epoch 95/100
368/368 [==============================] - 12s 34ms/step - loss: 0.2900 - sparse_categorical_accuracy: 0.9872 - val_loss: 1.0400 - val_sparse_categorical_accuracy: 0.8276
Epoch 96/100
368/368 [==============================] - 12s 33ms/step - loss: 0.2826 - sparse_categorical_accuracy: 0.9885 - val_loss: 1.0407 - val_sparse_categorical_accuracy: 0.8229
Epoch 97/100
368/368 [==============================] - 12s 33ms/step - loss: 0.2743 - sparse_categorical_accuracy: 0.9884 - val_loss: 1.0679 - val_sparse_categorical_accuracy: 0.8093
Epoch 98/100
368/368 [==============================] - 12s 33ms/step - loss: 0.2891 - sparse_categorical_accuracy: 0.9848 - val_loss: 1.0843 - val_sparse_categorical_accuracy: 0.8251
Epoch 99/100
368/368 [==============================] - 12s 33ms/step - loss: 0.2863 - sparse_categorical_accuracy: 0.9853 - val_loss: 0.9928 - val_sparse_categorical_accuracy: 0.8234
Epoch 100/100
368/368 [==============================] - 12s 34ms/step - loss: 0.2782 - sparse_categorical_accuracy: 0.9880 - val_loss: 1.1688 - val_sparse_categorical_accuracy: 0.8079