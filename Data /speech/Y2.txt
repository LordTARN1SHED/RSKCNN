Epoch 1/20
1323/1323 [==============================] - 22s 15ms/step - loss: 1.0302 - accuracy: 0.7176 - val_loss: 0.5316 - val_accuracy: 0.8458
Epoch 2/20
1323/1323 [==============================] - 17s 13ms/step - loss: 0.4107 - accuracy: 0.8786 - val_loss: 0.4657 - val_accuracy: 0.8669
Epoch 3/20
1323/1323 [==============================] - 17s 13ms/step - loss: 0.3000 - accuracy: 0.9084 - val_loss: 0.5090 - val_accuracy: 0.8601
Epoch 4/20
1323/1323 [==============================] - 17s 13ms/step - loss: 0.2708 - accuracy: 0.9170 - val_loss: 0.4148 - val_accuracy: 0.8842
Epoch 5/20
1321/1323 [============================>.] - ETA: 0s - loss: 0.2621 - accuracy: 0.9199WARNING:tensorflow:5 out of the last 5 calls to <function SparseConv2D.update_p at 0x00000215BEDD43A0> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
1323/1323 [==============================] - 17s 13ms/step - loss: 0.2619 - accuracy: 0.9199 - val_loss: 0.4027 - val_accuracy: 0.8881
Epoch 6/20
1323/1323 [==============================] - 17s 13ms/step - loss: 0.2802 - accuracy: 0.9126 - val_loss: 0.3962 - val_accuracy: 0.8921
Epoch 7/20
1323/1323 [==============================] - 17s 13ms/step - loss: 0.2430 - accuracy: 0.9243 - val_loss: 0.3953 - val_accuracy: 0.8936
Epoch 8/20
1323/1323 [==============================] - 16s 12ms/step - loss: 0.2176 - accuracy: 0.9327 - val_loss: 0.4078 - val_accuracy: 0.8953
Epoch 9/20
1323/1323 [==============================] - 16s 12ms/step - loss: 0.2018 - accuracy: 0.9370 - val_loss: 0.3896 - val_accuracy: 0.8981
Epoch 10/20
1323/1323 [==============================] - 16s 12ms/step - loss: 0.1872 - accuracy: 0.9414 - val_loss: 0.4198 - val_accuracy: 0.8888
Epoch 11/20
1323/1323 [==============================] - 16s 12ms/step - loss: 0.1745 - accuracy: 0.9471 - val_loss: 0.3988 - val_accuracy: 0.9000
Epoch 12/20
1323/1323 [==============================] - 16s 12ms/step - loss: 0.1601 - accuracy: 0.9498 - val_loss: 0.4129 - val_accuracy: 0.9005
Epoch 13/20
1323/1323 [==============================] - 16s 12ms/step - loss: 0.1538 - accuracy: 0.9520 - val_loss: 0.4132 - val_accuracy: 0.8986
Epoch 14/20
1323/1323 [==============================] - 16s 12ms/step - loss: 0.1425 - accuracy: 0.9556 - val_loss: 0.4263 - val_accuracy: 0.9012
Epoch 15/20
1323/1323 [==============================] - 16s 12ms/step - loss: 0.1363 - accuracy: 0.9575 - val_loss: 0.4229 - val_accuracy: 0.9021
Epoch 16/20
1323/1323 [==============================] - 16s 12ms/step - loss: 0.1318 - accuracy: 0.9589 - val_loss: 0.4336 - val_accuracy: 0.9010
Epoch 17/20
1323/1323 [==============================] - 16s 12ms/step - loss: 0.1251 - accuracy: 0.9610 - val_loss: 0.4412 - val_accuracy: 0.9070
Epoch 18/20
1323/1323 [==============================] - 16s 12ms/step - loss: 0.1160 - accuracy: 0.9631 - val_loss: 0.4584 - val_accuracy: 0.8991
Epoch 19/20
1323/1323 [==============================] - 16s 12ms/step - loss: 0.1112 - accuracy: 0.9653 - val_loss: 0.4104 - val_accuracy: 0.9003
Epoch 20/20
1323/1323 [==============================] - 15s 12ms/step - loss: 0.1074 - accuracy: 0.9669 - val_loss: 0.4364 - val_accuracy: 0.9031
166/166 [==============================] - 3s 15ms/step - loss: 0.4467 - accuracy: 0.8964
Test accuracy: 0.896447479724884